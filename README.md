# Human_2 — проект

Документация проекта, серьёзные изменения, планы и задачи.

**Правило ведения README (обязательно):**
- Записывать сюда все **серьёзные изменения** (новые файлы, смена логики, доработки).
- Хранить **описание проекта**, **документацию** и **планы/todo**.
- **Обновлять README после каждого серьёзного изменения.**
- **Всегда обновлять эту документацию по завершении работы** над задачей или этапом.

---

## Описание проекта

Реализация индикатора для MetaTrader 4 (MQL4): **уровни Фибоначчи по заданному временному интервалу** с вложенностью до 4 уровней.

### Основные возможности

- Расчёт **минимума и максимума цены** на заданном интервале времени (или на последних N барах).
- Построение **уровней Фибоначчи** по процентам: 23.6, 38.2, 50, 61.8, 76.4 (0% = минимум, 100% = максимум).
- **Четыре уровня вложенности:** уровень 1 — между min и max; уровни 2–4 — между соседними границами предыдущего уровня.
- Для каждого уровня — настройки **цвета, толщины и типа линии**, а также **включение/отключение** отображения.
- Подписи к линиям в формате **F1 23.6%**, F2 38.2% и т.д.

### Файлы

| Файл | Описание |
|------|----------|
| `FibonacciLevelsInterval.mq4` | Индикатор MQL4: один файл, компилируется в MetaTrader 4. |

---

## Документация индикатора

### Параметры (inputs)

- **TimeStart** — начало интервала (datetime). `0` = не задано.
- **TimeEnd** — конец интервала (datetime). `0` = не задано.
- **BarsBack** — число баров для расчёта, если интервал не задан (по умолчанию 100).

Для уровней 1–4:

- **ShowLevel1 … ShowLevel4** — показывать линии данного уровня (bool).
- **Color1 … Color4** — цвет линии.
- **Width1 … Width4** — толщина (1–5).
- **Style1 … Style4** — тип линии (SOLID, DASH, DOT и т.д.).

Значения по умолчанию:

- Уровень 1: красный, толстая (2), сплошная.
- Уровень 2: оранжевый, средняя (1), сплошная.
- Уровень 3: жёлтый, тонкая (1), сплошная.
- Уровень 4: зелёный, тонкая (1), прерывистая (DASH).

### Алгоритм

1. По **TimeStart** и **TimeEnd** находятся бары интервала; по ним — **min(Low)** и **max(High)**.
2. **Уровень 1:** 0% = min, 100% = max; строятся 5 линий по 23.6, 38.2, 50, 61.8, 76.4%.
3. **Уровень 2:** между каждой парой соседних цен уровня 1 (6 отрезков) снова считаются те же 5% → 30 линий.
4. **Уровень 3:** границы = объединение уровней 1 и 2 (отсортировано); между соседними — 5% → 180 линий.
5. **Уровень 4:** границы = уровни 1–3; между соседними — 5% → 1080 линий.

Время на графике — серверное (символ графика).

### Отрисовка

- Горизонтальные линии — объекты **OBJ_TREND** с двумя точками на одной цене (от TimeStart до TimeEnd).
- Подписи — **OBJ_TEXT** у правого края линии.
- Все объекты индикатора имеют префикс `FibLV_`; при перерасчёте и при снятии индикатора они удаляются.

---

## Планы и задачи (TODO)

- [x] Параметры: TimeStart, TimeEnd, ShowLevel1–4, Color/Width/Style.
- [x] Поиск min/max на временном интервале (обход баров).
- [x] Уровень 1: 5 линий Фибо между priceMin и priceMax.
- [x] Уровни 2–4: вложенный расчёт между соседними границами.
- [x] Отрисовка линий OBJ_TREND, удаление по префиксу, подписи F1 23.6% и т.д.

Все задачи по текущему плану выполнены.

---

## История серьёзных изменений

| Дата | Изменение |
|------|-----------|
| 2025-02-23 | Создан индикатор `FibonacciLevelsInterval.mq4`: расчёт min/max на интервале, уровни Фибоначчи 1–4 с вложенностью, настраиваемые линии и подписи. |
| 2025-02-23 | Добавлен README.md: описание проекта, документация индикатора, планы и история изменений. Установлено правило обновления README после серьёзных изменений и по завершении работы. |
| 2025-02-23 | Подтверждено правило: вести README.md для всех проектов — записывать серьёзные изменения, описание, документацию, планы/todo; обновлять после каждого серьёзного изменения и всегда по завершении работы. |
| 2025-02-23 | Формализовано правило в начале README: при работе над проектами всегда вести README — записывать серьёзные изменения, описание, документацию, планы/todo; обновлять после каждого серьёзного изменения и обязательно по завершении. |

---

## Правило ведения README (для всех проектов)

- Записывать в README все **серьёзные изменения** (новые файлы, смена логики, важные доработки).
- Хранить здесь **описание проекта**, **документацию** и **планы/todo**.
- **Обновлять README после каждого серьёзного изменения.**
- **Всегда обновлять документацию по завершении работы** над задачей или этапом.
